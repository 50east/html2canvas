/*
 html2canvas v0.33 <http://html2canvas.hertzen.com>
 Copyright (c) 2011 Niklas von Hertzen. All rights reserved.
 http://www.twitter.com/niklasvh

 Released under MIT License
*/
(function(k,w,m){function H(a){g.logging&&k.console&&k.console.log&&k.console.log(a)}function U(a,b){var d=[];return{storage:d,width:a,height:b,fillRect:function(){d.push({type:"function",name:"fillRect",arguments:arguments})},drawImage:function(){d.push({type:"function",name:"drawImage",arguments:arguments})},fillText:function(){d.push({type:"function",name:"fillText",arguments:arguments})},setVariable:function(a,b){d.push({type:"variable",name:a,arguments:b})}}}var g={},E;g.Util={};g.Util.backgroundImage=
function(a){if(/data:image\/.*;base64,/i.test(a)||/^(-webkit|-moz|linear-gradient|-o-)/.test(a))return a;a.toLowerCase().substr(0,5)==='url("'?(a=a.substr(5),a=a.substr(0,a.length-2)):(a=a.substr(4),a=a.substr(0,a.length-1));return a};g.Util.Bounds=function(a){var b={};if(a.getBoundingClientRect)return a=a.getBoundingClientRect(),b.top=a.top,b.bottom=a.bottom||a.top+a.height,b.left=a.left,b.width=a.width||a.right-a.left,b.height=a.height||a.bottom-a.top,b};g.Util.getCSS=function(a,b){function d(b,
c){var f=a.runtimeStyle&&a.runtimeStyle[b],d,h=a.style;if(!/^-?[0-9]+\.?[0-9]*(?:px)?$/i.test(c)&&/^-?\d/.test(c)){d=h.left;if(f)a.runtimeStyle.left=a.currentStyle.left;h.left=b==="fontSize"?"1em":c||0;c=h.pixelLeft+"px";h.left=d;if(f)a.runtimeStyle.left=f}return!/^(thin|medium|thick)$/i.test(c)?Math.round(parseFloat(c))+"px":c}var f;if(k.getComputedStyle)f=w.defaultView.getComputedStyle(a,null)[b],b==="backgroundPosition"&&(f=(f.split(",")[0]||"0 0").split(" "),f[0]=f[0].indexOf("%")===-1?d(b+"X",
f[0]):f[0],f[1]=f[1]===m?f[0]:f[1],f[1]=f[1].indexOf("%")===-1?d(b+"Y",f[1]):f[1]);else if(a.currentStyle)if(b==="backgroundPosition")f=[d(b+"X",a.currentStyle[b+"X"]),d(b+"Y",a.currentStyle[b+"Y"])];else if(f=d(b,a.currentStyle[b]),/^(border)/i.test(b)&&/^(medium|thin|thick)$/i.test(f))switch(f){case "thin":f="1px";break;case "medium":f="0px";break;case "thick":f="5px"}return f};g.Util.BackgroundPosition=function(a,b,d){var a=g.Util.getCSS(a,"backgroundPosition"),f,e;a.length===1&&(f=a,a=[],a[0]=
f,a[1]=f);a[0].toString().indexOf("%")!==-1?(e=parseFloat(a[0])/100,f=b.width*e-d.width*e):f=parseInt(a[0],10);a[1].toString().indexOf("%")!==-1?(e=parseFloat(a[1])/100,b=b.height*e-d.height*e):b=parseInt(a[1],10);return{top:b,left:f}};g.Util.Extend=function(a,b){for(var d in a)a.hasOwnProperty(d)&&(b[d]=a[d]);return b};g.Util.Children=function(a){var b;try{b=$(a).contents()}catch(d){H("html2canvas.Util.Children failed with exception: "+d.message),b=[]}return b};g.Generate={};g.Generate.Gradient=
function(a,b){function d(a){for(var b=-1,c="",t;b++<a.length;)if(t=a.charAt(b),t===")"){if(c+=t,I.push(c),c="",b=a.indexOf(",",b)+1,b===0)break}else c+=t}var f=w.createElement("canvas"),e=f.getContext("2d"),c,g=0,D=0,h=0,k=0,I=[],m,x;f.width=b.width;f.height=b.height;if((c=a.match(/-webkit-linear-gradient\((.*)\)/))!==null){m=c[1].split(",",1)[0];d(c[1].substr(m.length+2));m=m.split(" ");x=0;for(c=m.length;x<c;x+=1)switch(m[x]){case "top":k=b.height;break;case "right":g=b.width;break;case "bottom":D=
b.height;break;case "left":h=b.width}}else if((c=a.match(/-webkit-gradient\(linear, (\d+)[%]{0,1} (\d+)[%]{0,1}, (\d+)[%]{0,1} (\d+)[%]{0,1}, from\((.*)\), to\((.*)\)\)/))!==null)g=c[1]*b.width/100,D=c[2]*b.height/100,h=c[3]*b.width/100,k=c[4]*b.height/100,I.push(c[5]),I.push(c[6]);else if((c=a.match(/-moz-linear-gradient\((\d+)[%]{0,1} (\d+)[%]{0,1}, (.*)\)/))!==null)g=c[1]*b.width/100,D=c[2]*b.width/100,h=b.width-g,k=b.height-D,d(c[3]);else return;D=e.createLinearGradient(g,D,h,k);h=1/(I.length-
1);g=0;for(c=I.length;g<c;g+=1)try{D.addColorStop(h*g,I[g])}catch(i){H(["failed to add color stop: ",i,"; tried to add: ",I[g],"; stop: ",g,"; in: ",a])}e.fillStyle=D;e.fillRect(0,0,b.width,b.height);e=new Image;e.src=f.toDataURL();return e};g.Generate.ListAlpha=function(a){var b="",d;do d=a%26,b=String.fromCharCode(d+64)+b,a/=26;while(a*26>26);return b};g.Generate.ListRoman=function(a){var b=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],d=[1E3,900,500,400,100,90,50,40,10,9,5,4,1],f=
"",e,c=b.length;if(a<=0||a>=4E3)return a;for(e=0;e<c;e+=1)for(;a>=d[e];)a-=d[e],f+=b[e];return f};g.Parse=function(a,b){function d(l,a){var b=parseInt(y(l,a),10);return isNaN(b)?0:b}function f(l,a,b,c,f,e){e!=="transparent"&&(l.setVariable("fillStyle",e),l.fillRect(a,b,c,f),t+=1)}function e(l,a){switch(a){case "lowercase":return l.toLowerCase();case "capitalize":return l.replace(/(^|\s|:|-|\(|\))([a-z])/g,function(l,a,b){if(l.length>0)return a+b.toUpperCase()});case "uppercase":return l.toUpperCase();
default:return l}}function c(l){return l.replace(/^\s*/g,"").replace(/\s*$/g,"")}function A(l,a,d){var d=d.ctx,q=y(l,"fontFamily"),h=y(l,"fontSize"),P=y(l,"color"),S=y(l,"textDecoration"),L=y(l,"textAlign"),r=y(l,"letterSpacing"),C,z,n=y(l,"fontWeight"),o=y(l,"fontStyle"),u=y(l,"fontVariant"),D=0,p;a.nodeValue=e(a.nodeValue,y(l,"textTransform"));if(c(a.nodeValue).length>0){if(S!=="none")if(v[q+"-"+h]!==m)z=v[q+"-"+h];else{z=s.createElement("div");l=s.createElement("img");p=s.createElement("span");
var x;z.style.visibility="hidden";z.style.fontFamily=q;z.style.fontSize=h;z.style.margin=0;z.style.padding=0;j.appendChild(z);l.src="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=";l.width=1;l.height=1;l.style.margin=0;l.style.padding=0;l.style.verticalAlign="baseline";p.style.fontFamily=q;p.style.fontSize=h;p.style.margin=0;p.style.padding=0;p.appendChild(s.createTextNode("Hidden Text"));z.appendChild(p);z.appendChild(l);x=l.offsetTop-p.offsetTop+1;z.removeChild(p);z.appendChild(s.createTextNode("Hidden Text"));
z.style.lineHeight="normal";l.style.verticalAlign="super";l={baseline:x,lineWidth:1,middle:l.offsetTop-z.offsetTop+1};v[q+"-"+h]=l;j.removeChild(z);z=l}L=L.replace(["-webkit-auto"],["auto"]);L=b.letterRendering===!1&&/^(left|right|justify|auto)$/.test(L)&&/^(normal|none)$/.test(r)?a.nodeValue.split(/(\b| )/):a.nodeValue.split("");switch(parseInt(n,10)){case 401:n="bold";break;case 400:n="normal"}d.setVariable("fillStyle",P);d.setVariable("font",o+" "+u+" "+n+" "+h+" "+q);d.setVariable("textAlign",
"left");h=a;n=0;for(q=L.length;n<q;n+=1){o=null;if(J.rangeBounds){if(S!=="none"||c(L[n]).length!==0)o=L[n],s.createRange?(C=s.createRange(),C.setStart(a,D),C.setEnd(a,D+o.length)):C=j.createTextRange(),C=C.getBoundingClientRect()?C.getBoundingClientRect():{}}else{if(typeof h.nodeValue!=="string")continue;u=h.splitText(L[n].length);r=h.parentNode;l=s.createElement("wrapper");p=h.cloneNode(!0);l.appendChild(h.cloneNode(!0));r.replaceChild(l,h);C=g.Util.Bounds(l);o=h.nodeValue;h=u;r.replaceChild(p,l)}if(o!==
null)u=C.left,r=C.bottom,l=d,c(o).length>0&&(l.fillText(o,u,r),t+=1);switch(S){case "underline":f(d,C.left,Math.round(C.top+z.baseline+z.lineWidth),C.width,1,P);break;case "overline":f(d,C.left,C.top,C.width,1,P);break;case "line-through":f(d,C.left,Math.ceil(C.top+z.middle+z.lineWidth),C.width,1,P)}D+=L[n].length}}}function D(l){return(l=a[l])&&l.succeeded===!0?l.img:!1}function h(l,a){var b=Math.max(l.left,a.left),c=Math.max(l.top,a.top);return{left:b,top:c,width:Math.min(l.left+l.width,a.left+
a.width)-b,height:Math.min(l.top+l.height,a.top+a.height)-c}}function R(a,b,c,e){for(var q=c.left,t=c.top,g=c.width,c=c.height,s,r,v,j,n,o=function(a){var l=[],b=["Top","Right","Bottom","Left"],c;for(c=0;c<4;c+=1)l.push({width:d(a,"border"+b[c]+"Width"),color:y(a,"border"+b[c]+"Color")});return l}(a),a=0;a<4;a+=1)if(s=o[a],s.width>0){r=q;v=t;j=g;n=c-o[2].width;switch(a){case 0:n=o[0].width;break;case 1:r=q+g-o[1].width;j=o[1].width;break;case 2:v=v+c-o[2].width;n=o[2].width;break;case 3:j=o[3].width}j=
{left:r,top:v,width:j,height:n};e&&(j=h(j,e));j.width>0&&j.height>0&&f(b,r,v,j.width,j.height,s.color)}return o}function I(a,b,c){var d=s.createElement("valuewrap"),e=["lineHeight","textAlign","fontFamily","color","fontSize","paddingLeft","paddingTop","width","height","border","borderLeftWidth","borderTopWidth"],q,t,f;q=0;for(t=e.length;q<t;q+=1){f=e[q];try{d.style[f]=y(a,f)}catch(h){H("html2canvas: Parse: Exception caught in renderFormValue: "+h.message)}}d.style.borderColor="black";d.style.borderStyle=
"solid";d.style.display="block";d.style.position="absolute";if(/^(submit|reset|button|text|password)$/.test(a.type)||a.nodeName==="SELECT")d.style.lineHeight=y(a,"height");d.style.top=b.top+"px";d.style.left=b.left+"px";b=s.createTextNode(a.nodeName==="SELECT"?a.options[a.selectedIndex].text:a.value);d.appendChild(b);j.appendChild(d);A(a,b,c);j.removeChild(d)}function E(a,b,c,d,q,e,f,h){var g=0,j=0;f-c>0&&(g=f-c);h-d>0&&(j=h-d);a.drawImage(b,g,j,q-g,e-j,c+g,d+j,q-g,e-j);t+=1}function x(a,b,c,d,q,
e,f){var f=Math.min(b.height,f),h,t;c.left-=Math.ceil(c.left/b.width)*b.width;for(t=d+c.left;t<e+d;)h=Math.floor(t+b.width)>e+d?e+d-t:b.width,E(a,b,t,q+c.top,h,f,d,q),t=Math.floor(t+b.width)}function i(a,q){var e=g.Util.Bounds(a),j=e.left,v=e.top,k=e.width,i=e.height,m,r=y(a,"backgroundColor"),C=y(a,"position"),z,n=y(a,"opacity"),o,u;q?Q={}:(Q={width:Math.max(Math.max(s.body.scrollWidth,s.documentElement.scrollWidth),Math.max(s.body.offsetWidth,s.documentElement.offsetWidth),Math.max(s.body.clientWidth,
s.documentElement.clientWidth)),height:Math.max(Math.max(s.body.scrollHeight,s.documentElement.scrollHeight),Math.max(s.body.offsetHeight,s.documentElement.offsetHeight),Math.max(s.body.clientHeight,s.documentElement.clientHeight))},q={opacity:1});u=y(a,"zIndex");(z=q.zIndex)?u!=="auto"&&(u={zindex:u,children:[]},z.children.push(u),z=u):z=u={zindex:0,children:[]};o={ctx:U(Q.width||k,Q.height||i),zIndex:z,opacity:n*q.opacity,cssPosition:C};if(q.clip)o.clip=g.Util.Extend({},q.clip);if(b.useOverflow===
!0&&/(hidden|scroll|auto)/.test(y(a,"overflow"))===!0&&/(BODY)/i.test(a.nodeName)===!1)o.clip=o.clip?h(o.clip,e):e;C=z.children.push(o);u=z.children[C-1].ctx;u.setVariable("globalAlpha",o.opacity);n=R(a,u,e,!1);o.borders=n;M.test(a.nodeName)&&b.iframeDefault!=="transparent"&&(r=b.iframeDefault==="default"?"#efefef":b.iframeDefault);k={left:j+n[3].width,top:v+n[0].width,width:k-(n[1].width+n[3].width),height:i-(n[0].width+n[2].width)};o.clip&&(k=h(k,o.clip));if(k.height>0&&k.width>0){f(u,k.left,k.top,
k.width,k.height,r);var B=k,p=y(a,"backgroundImage"),F=y(a,"backgroundRepeat").split(",")[0],A,G,w;!/data:image\/.*;base64,/i.test(p)&&!/^(-webkit|-moz|linear-gradient|-o-)/.test(p)&&(p=p.split(",")[0]);if(typeof p!=="undefined"&&/^(1|none)$/.test(p)===!1)if(p=g.Util.backgroundImage(p),r=D(p),i=g.Util.BackgroundPosition(a,B,r),r)switch(F){case "repeat-x":x(u,r,i,B.left,B.top,B.width,B.height);break;case "repeat-y":p=B.left;F=B.top;A=B.height;G=Math.min(r.width,B.width);i.top-=Math.ceil(i.top/r.height)*
r.height;for(w=F+i.top;w<A+F;)B=Math.floor(w+r.height)>A+F?A+F-w:r.height,E(u,r,p+i.left,w,G,B,p,F),w=Math.floor(w+r.height);break;case "no-repeat":p=B.width-i.left;w=B.height-i.top;F=i.left;A=i.top;G=i.left+B.left;i=i.top+B.top;F<0?(F=Math.abs(F),G+=F,p=Math.min(B.width,r.width-F)):(p=Math.min(p,r.width),F=0);A<0?(A=Math.abs(A),i+=A,w=Math.min(B.height,r.height-A)):(w=Math.min(w,r.height),A=0);w>0&&p>0&&(u.drawImage(r,F,A,p,w,G,i,p,w),t+=1);break;default:i.top-=Math.ceil(i.top/r.height)*r.height;
for(p=B.top+i.top;p<B.height+B.top;)F=Math.min(r.height,B.height+B.top-p),F=Math.floor(p+r.height)>F+p?F+p-p:r.height,p<B.top?(A=B.top-p,p=B.top):A=0,x(u,r,i,B.left,p,B.width,F),A>0&&(i.top+=A),p=Math.floor(p+r.height)-A}else H("html2canvas: Error loading background:"+p)}switch(a.nodeName){case "IMG":o=a.getAttribute("src");(m=D(o))?(o=d(a,"paddingLeft"),k=d(a,"paddingTop"),r=d(a,"paddingRight"),i=d(a,"paddingBottom"),u.drawImage(m,0,0,m.width,m.height,j+o+n[3].width,v+k+n[0].width,e.width-(n[1].width+
n[3].width+o+r),e.height-(n[0].width+n[2].width+k+i)),t+=1):H("html2canvas: Error loading <img>:"+o);break;case "INPUT":/^(text|url|email|submit|button|reset)$/.test(a.type)&&a.value.length>0&&I(a,e,o);break;case "TEXTAREA":a.value.length>0&&I(a,e,o);break;case "SELECT":a.options.length>0&&I(a,e,o);break;case "LI":e=k;j=y(a,"listStylePosition");n=y(a,"listStyleType");v=y(a,"fontWeight");if(/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(n)){u=
$(a).index()+1;switch(n){case "decimal":m=u;break;case "decimal-leading-zero":m=u.toString().length===1?"0"+u.toString():u.toString();break;case "upper-roman":m=g.Generate.ListRoman(u);break;case "lower-roman":m=g.Generate.ListRoman(u).toLowerCase();break;case "lower-alpha":m=g.Generate.ListAlpha(u).toLowerCase();break;case "upper-alpha":m=g.Generate.ListAlpha(u)}m+=". ";o=m;n=s.createElement("boundelement");n.style.display="inline";u=a.style.listStyleType;a.style.listStyleType="none";n.appendChild(s.createTextNode(o));
a.insertBefore(n,a.firstChild);o=g.Util.Bounds(n);a.removeChild(n);a.style.listStyleType=u;switch(v){case 401:v="bold";break;case 400:v="normal"}N.setVariable("fillStyle",y(a,"color"));N.setVariable("font",y(a,"fontVariant")+" "+v+" "+y(a,"fontStyle")+" "+y(a,"fontSize")+" "+y(a,"fontFamily"));if(j==="inside")N.setVariable("textAlign","left"),e=e.left,j=o.bottom,v=N,c(m).length>0&&(v.fillText(m,e,j),t+=1)}break;case "CANVAS":o=d(a,"paddingLeft"),k=d(a,"paddingTop"),r=d(a,"paddingRight"),i=d(a,"paddingBottom"),
u.drawImage(a,0,0,a.width,a.height,j+o+n[3].width,v+k+n[0].width,e.width-(n[1].width+n[3].width+o+r),e.height-(n[0].width+n[2].width+k+i)),t+=1}return z.children[C-1]}function O(a,b){if(y(a,"display")!=="none"&&y(a,"visibility")!=="hidden"&&(b=i(a,b)||b,N=b.ctx,!M.test(a.nodeName))){var c=g.Util.Children(a),e,d,q;e=0;for(q=c.length;e<q;e+=1)d=c[e],d.nodeType===1?O(d,b):d.nodeType===3&&A(a,d,b)}}k.scroll(0,0);var J={rangeBounds:!1},q=b.elements===m?w.body:b.elements[0],t=0,v={},s=q.ownerDocument,M=
RegExp("("+b.ignoreElements+")"),j=s.body,G,K,N,Q,T,a=a||{};if(s.createRange&&(G=s.createRange(),G.getBoundingClientRect)){K=s.createElement("boundtest");K.style.height="123px";K.style.display="block";j.appendChild(K);G.selectNode(K);G=G.getBoundingClientRect();G=G.height;if(G===123)J.rangeBounds=!0;j.removeChild(K)}var y=g.Util.getCSS;K=i(q,null);G=0;q=q.children;for(T=q.length;G<T;G+=1)O(q[G],K);K.backgroundColor=y(w.documentElement,"backgroundColor");return K};g.Preload=function(a){function b(){H("html2canvas: start: images: "+
c.numLoaded+" / "+c.numTotal+" (failed: "+c.numFailed+")");!c.firstRun&&c.numLoaded>=c.numTotal&&(H("Finished loading images: # "+c.numTotal+" (failed: "+c.numFailed+")"),typeof a.complete==="function"&&a.complete(c))}function d(d,t,f){var h,g=a.proxy,j;i.href=d;d=i.href;h="html2canvas_"+R++;f.callbackname=h;g+=g.indexOf("?")>-1?"&":"?";g+="url="+encodeURIComponent(d)+"&callback="+h;j=I.createElement("script");k[h]=function(a){a.substring(0,6)==="error:"?(f.succeeded=!1,c.numLoaded++,c.numFailed++,
b()):(e(t,f),t.src=a);k[h]=m;try{delete k[h]}catch(d){}j.parentNode.removeChild(j);j=null;delete f.script;delete f.callbackname};j.setAttribute("type","text/javascript");j.setAttribute("src",g);f.script=j;k.document.body.appendChild(j)}function f(a){var d=g.Util.Children(a),e,h=d.length,i,j=!1;for(e=0;e<h;e+=1)f(d[e]);try{j=a.nodeType}catch(k){j=!1,H("html2canvas: failed to access some element's nodeType - Exception: "+k.message)}if(j===1||j===m){try{i=g.Util.getCSS(a,"backgroundImage")}catch(A){H("html2canvas: failed to get background-image - Exception: "+
A.message)}i&&i!=="1"&&i!=="none"&&(/^(-webkit|-o|-moz|-ms|linear)-/.test(i)?(a=g.Generate.Gradient(i,g.Util.Bounds(a)),a!==m&&(c[i]={img:a,succeeded:!0},c.numTotal++,c.numLoaded++,b())):(i=g.Util.backgroundImage(i.match(/data:image\/.*;base64,/i)?i:i.split(",")[0]),D.loadImage(i)))}}function e(e,f){e.onload=function(){f.timer!==m&&k.clearTimeout(f.timer);c.numLoaded++;f.succeeded=!0;b()};e.onerror=function(){if(e.crossOrigin==="anonymous"&&(k.clearTimeout(f.timer),a.proxy)){var h=e.src;e=new Image;
f.img=e;e.src=h;d(e.src,e,f);return}c.numLoaded++;c.numFailed++;f.succeeded=!1;b()}}var c={numLoaded:0,numFailed:0,numTotal:0,cleanupDone:!1},A,D,h,R=0;h=a.elements[0]||w.body;var I=h.ownerDocument,E=I.images,x=E.length,i=I.createElement("a"),O=function(a){return a.crossOrigin!==m}(new Image),J;i.href=k.location.href;A=i.protocol+i.host;D={loadImage:function(b){var f,h;if(b&&c[b]===m)f=new Image,b.match(/data:image\/.*;base64,/i)?(f.src=b.replace(/url\(['"]{0,}|['"]{0,}\)$/ig,""),h=c[b]={img:f},c.numTotal++,
e(f,h)):(i.href=b,i.href=i.href,i.protocol+i.host===A||a.allowTaint===!0?(h=c[b]={img:f},c.numTotal++,e(f,h),f.src=b):O&&!a.allowTaint&&a.useCORS?(f.crossOrigin="anonymous",h=c[b]={img:f},c.numTotal++,e(f,h),f.src=b,f.customComplete=function(){if(this.img.complete)this.img.onerror();else this.timer=k.setTimeout(this.img.customComplete,100)}.bind(h),f.customComplete()):a.proxy&&(h=c[b]={img:f},c.numTotal++,d(b,f,h)))},cleanupDOM:function(e){var d,f;if(!c.cleanupDone){e&&typeof e==="string"?H("html2canvas: Cleanup because: "+
e):H("html2canvas: Cleanup after timeout: "+a.timeout+" ms.");for(f in c)if(c.hasOwnProperty(f)&&(d=c[f],typeof d==="object"&&d.callbackname&&d.succeeded===m)){k[d.callbackname]=m;try{delete k[d.callbackname]}catch(h){}d.script&&d.script.parentNode&&(d.script.setAttribute("src","about:blank"),d.script.parentNode.removeChild(d.script));c.numLoaded++;c.numFailed++;H("html2canvas: Cleaned up failed img: '"+f+"' Steps: "+c.numLoaded+" / "+c.numTotal)}k.stop!==m?k.stop():w.execCommand!==m&&w.execCommand("Stop",
!1);w.close!==m&&w.close();c.cleanupDone=!0;e&&typeof e==="string"||b()}},renderingDone:function(){J&&k.clearTimeout(J)}};a.timeout>0&&(J=k.setTimeout(D.cleanupDOM,a.timeout));H("html2canvas: Preload starts: finding background-images");c.firstRun=!0;f(h);H("html2canvas: Preload: Finding images");for(h=0;h<x;h+=1)D.loadImage(E[h].getAttribute("src"));c.firstRun=!1;H("html2canvas: Preload: Done.");c.numTotal===c.numLoaded&&b();return D};g.Renderer=function(a,b){function d(a){var b=[],g=[],a=a.children,
k,h,m,w;k=0;for(m=a.length;k<m;k+=1)h=a[k],h.children&&h.children.length>0?(b.push(h),g.push(h.zindex)):f.push(h);g.sort(function(a,b){return a-b});a=0;for(k=g.length;a<k;a+=1){h=g[a];m=0;for(w=b.length;m<=w;m+=1)if(b[m].zindex===h){h=b.splice(m,1);d(h[0]);break}}}var f=[];d(a.zIndex);if(typeof b.renderer._create!=="function")throw Error("Invalid renderer defined");return b.renderer._create(a,b,w,f,g)};E=function(a,b){var d,f,e={logging:!1,elements:a,proxy:"http://html2canvas.appspot.com/",timeout:0,
useCORS:!1,allowTaint:!1,iframeDefault:"default",ignoreElements:"IFRAME|OBJECT|PARAM",useOverflow:!0,letterRendering:!1,flashcanvas:m,width:null,height:null,taintTest:!0},e=g.Util.Extend(b,e);e.renderer=e.renderer||E.Renderer.Canvas(e);g.logging=e.logging;e.complete=function(a){if(!(typeof e.onpreloaded==="function"&&e.onpreloaded(a)===!1)&&(d=g.Parse(a,e),!(typeof e.onparsed==="function"&&e.onparsed(d)===!1)&&(f=g.Renderer(d,e),typeof e.onrendered==="function")))e.onrendered(f)};k.setTimeout(function(){g.Preload(e)},
0);return{render:function(a,b){return g.Renderer(a,g.Util.Extend(b,e))},parse:function(a,b){return g.Parse(a,g.Util.Extend(b,e))},preload:function(a){return g.Preload(g.Util.Extend(a,e))},log:H}};E.log=H;E.Renderer={Canvas:m};E.Renderer.Canvas=function(a){var a=a||{},b=a.canvas||w.createElement("canvas"),d=!1,f=!1,e=!1,c;if(b.getContext)E.log("html2canvas: Renderer: using canvas renderer"),e=!0;else if(a.flashcanvas!==m){d=!0;E.log("html2canvas: Renderer: canvas not available, using flashcanvas");
var g=w.createElement("script");g.src=a.flashcanvas;g.onload=function(a,b){var d;if(a.onload===m)a.onreadystatechange!==m?(d=function(){a.readyState!=="loaded"&&a.readyState!=="complete"?k.setTimeout(d,250):b()},k.setTimeout(d,250)):E.log("html2canvas: Renderer: Can't track when flashcanvas is loaded");else return b}(g,function(){typeof k.FlashCanvas!=="undefined"&&(E.log("html2canvas: Renderer: Flashcanvas initialized"),k.FlashCanvas.initElement(b),e=!0,f!==!1&&c._create.apply(null,f))});w.body.appendChild(g)}return c=
{_create:function(a,c,g,k,A){if(!e)return f=arguments,b;var x=b.getContext("2d"),i,E,J,q,t,v,s=w.createElement("canvas");t=s.getContext!==m;var M,j,s=t?s.getContext("2d"):{};v=[];b.width=b.style.width=!d?c.width||a.ctx.width:Math.min(2880,c.width||a.ctx.width);b.height=b.style.height=!d?c.height||a.ctx.height:Math.min(2880,c.height||a.ctx.height);i=x.fillStyle;x.fillStyle=a.backgroundColor;x.fillRect(0,0,b.width,b.height);x.fillStyle=i;E=0;for(J=k.length;E<J;E+=1){i=k.splice(0,1)[0];i.canvasPosition=
i.canvasPosition||{};x.textBaseline="bottom";i.clip&&(x.save(),x.beginPath(),x.rect(i.clip.left,i.clip.top,i.clip.width,i.clip.height),x.clip());if(i.ctx.storage){q=0;for(M=i.ctx.storage.length;q<M;q+=1)switch(j=i.ctx.storage[q],j.type){case "variable":x[j.name]=j.arguments;break;case "function":if(j.name==="fillRect")(!d||j.arguments[0]+j.arguments[2]<2880&&j.arguments[1]+j.arguments[3]<2880)&&x.fillRect.apply(x,j.arguments);else if(j.name==="fillText")(!d||j.arguments[1]<2880&&j.arguments[2]<2880)&&
x.fillText.apply(x,j.arguments);else if(j.name==="drawImage"&&j.arguments[8]>0&&j.arguments[7]){if(t&&c.taintTest&&v.indexOf(j.arguments[0].src)===-1){s.drawImage(j.arguments[0],0,0);try{s.getImageData(0,0,1,1)}catch(G){s=g.createElement("canvas");s=s.getContext("2d");continue}v.push(j.arguments[0].src)}x.drawImage.apply(x,j.arguments)}}}i.clip&&x.restore()}H("html2canvas: Renderer: Canvas renderer done - returning canvas obj");J=c.elements.length;return J===1&&typeof c.elements[0]==="object"&&c.elements[0].nodeName!==
"BODY"&&d===!1?(v=A.Util.Bounds(c.elements[0]),t=g.createElement("canvas"),t.width=v.width,t.height=v.height,x=t.getContext("2d"),x.drawImage(b,v.left,v.top,v.width,v.height,0,0,v.width,v.height),b=null,t):b}}};k.html2canvas=E})(window,document);